---
output: _output.yaml
---

## {data-background="img/mba_cover_image.png"}

## Connect With Us

<hr>

- Website     (https://www.rsquaredacademy.com/)
- Free Online R Courses   (https://rsquared-academy.thinkific.com/)
- R Packages  (https://pkgs.rsquaredacademy.com)
- Shiny Apps  (https://apps.rsquaredacademy.com)
- Blog        (https://blog.rsquaredacademy.com)
- GitHub      (https://github.com/rsquaredacademy)
- YouTube     (https://www.youtube.com/user/rsquaredin/)
- Twitter     (https://twitter.com/rsquaredacademy)
- Facebook    (https://www.facebook.com/rsquaredacademy/)
- Linkedin    (https://in.linkedin.com/company/rsquared-academy)

## Resources

<hr>

- <a href="https://slides.rsquaredacademy.com/mba/mba.html" target="_blank">Slides</a>
- <a href="https://github.com/rsquaredacademy-education/online-courses/tree/master/rfm-analysis-in-r" target="_blank">Code & Data</a>
- <a href="https://rstudio.cloud/project/335377" target="_blank">RStudio Cloud</a>
- <a href="https://www.rsquaredcomputing.com/shiny/rfm/" target="_blank">Shiny App</a>
- <a href="https://rfm.rsquaredacademy.com/" target="_blank">R Package</a>

## {data-background="img/ws_agenda.png"}

<br>
<br>
<br>
<br>
<br>
<br>

>- What?
>- Why?
>- How?
>- Demo

## {data-background="img/ws_section_intro.png"}

## Introduction

<hr>

```{r rfm_intro, fig.align='center', out.width="100%", echo=FALSE}

```

## What?

<hr>

```{r rfm_what, fig.align='center', out.width="100%", echo=FALSE}

```

## Why ?

<hr>

<br>
<br>

```{r rfm_why, fig.align='center', out.width="100%", echo=FALSE}

```

## {data-background="img/ws_section_case_studies.png"}

## Libraries

<hr>

```{r libs, message=FALSE, warning=FALSE}
library(rfm)
library(tibble)
library(knitr)
library(kableExtra)
library(magrittr)
library(dplyr)
library(ggplot2)
library(DT)
library(grDevices)
library(RColorBrewer)
```

## Data

<hr>

<br>
<br>

```{r data, echo=FALSE}
rfm_data_orders
```

## Data Dictionary

<hr>

## RFM Table

<hr>

<br>
<br>

```{r rfm_table_order2, eval=TRUE, echo=FALSE}
analysis_date <- lubridate::as_date("2006-12-31", tz = "UTC")
rfm_result <- rfm_table_order(rfm_data_orders, customer_id, order_date, revenue, analysis_date)
rfm_result %>%
  use_series(rfm) %>%
  slice(1:10) %>%
  kable() %>%
  kable_styling(full_width = TRUE, font_size = 12)
```

## Heatmap

<hr>

```{r heatmap, fig.align='center', fig.width=8, fig.height=6, echo=FALSE}
rfm_heatmap(rfm_result)
```

## Bar Chart

<hr>

```{r barchart, fig.align='center', fig.width=8, fig.height=6, echo=FALSE}
rfm_bar_chart(rfm_result)
```

## Histogram

<hr>

```{r rfmhist, fig.align='center', fig.width=8, fig.height=6, echo=FALSE}
rfm_histograms(rfm_result)
```

## Customers by Orders

<hr>

```{r rfmorders, fig.align='center', fig.width=8, fig.height=6, echo=FALSE}
rfm_order_dist(rfm_result)
```

## Recency vs Monetary Value

<hr>

```{r mr, fig.align='center', fig.width=7, fig.height=6, echo=FALSE}
rfm_rm_plot(rfm_result)
```

## Frequency vs Monetary Value

<hr>

```{r fm, fig.align='center', fig.width=7, fig.height=6, echo=FALSE}
rfm_fm_plot(rfm_result)
```

## Recency vs Frequency 

<hr>

```{r fr, fig.align='center', fig.width=7, fig.height=6, echo=FALSE}
rfm_rf_plot(rfm_result)
```

## Segments

<hr>

<br>
<br>

```{r segment_names, echo=FALSE, eval=TRUE}
segment <- c(
  "Champions", "Loyal Customers", "Potential Loyalist",
  "New Customers", "Promising", "Need Attention",
  "About To Sleep", "At Risk", "Can't Lose Them", "Hibernating",
  "Lost"
)
```

```{r segment_description, echo=FALSE, eval=TRUE}
description <- c(
  "Bought recently, buy often and spend the most",
  "Spend good money. Responsive to promotions",
  "Recent customers, spent good amount, bought more than once",
  "Bought more recently, but not often",
  "Recent shoppers, but haven't spent much",
  "Above average recency, frequency & monetary values",
  "Below average recency, frequency & monetary values",
  "Spent big money, purchased often but long time ago",
  "Made big purchases and often, but long time ago",
  "Low spenders, low frequency, purchased long time ago",
  "Lowest recency, frequency & monetary scores"
)
```

```{r segment_values, echo=FALSE, eval=TRUE}
recency <- c("4 - 5", "2 - 5", "3 - 5", "4 - 5", "3 - 4", "2 - 3", "2 - 3", "<= 2", "<= 1", "1 - 2", "<= 2")
frequency <- c("4 - 5", "3 - 5", "1 - 3", "<= 1", "<= 1", "2 - 3", "<= 2", "2 - 5", "4 - 5", "1 - 2", "<= 2")
monetary <- c("4 - 5", "3 - 5", "1 - 3", "<= 1", "<= 1", "2 - 3", "<= 2", "2 - 5", "4 - 5", "1 - 2", "<= 2")
segments <- tibble(
  Segment = segment, Description = description,
  R = recency, `F` = frequency, M = monetary
)
```

```{r segments, echo=FALSE, eval=TRUE}
segments %>%
  kable() %>%
  kable_styling(full_width = TRUE, font_size = 18)
```

## Segmented Customer Data

<hr>

```{r segment_data, echo=FALSE}
segment_names <- c("Champions", "Loyal Customers", "Potential Loyalist",
  "New Customers", "Promising", "Need Attention", "About To Sleep",
  "At Risk", "Can't Lose Them", "Lost")

recency_lower <- c(4, 2, 3, 4, 3, 2, 2, 1, 1, 1)
recency_upper <- c(5, 5, 5, 5, 4, 3, 3, 2, 1, 2)
frequency_lower <- c(4, 3, 1, 1, 1, 2, 1, 2, 4, 1)
frequency_upper <- c(5, 5, 3, 1, 1, 3, 2, 5, 5, 2)
monetary_lower <- c(4, 3, 1, 1, 1, 2, 1, 2, 4, 1)
monetary_upper <- c(5, 5, 3, 1, 1, 3, 2, 5, 5, 2)
segments <- rfm_segment(rfm_result, segment_names, recency_lower, recency_upper,
frequency_lower, frequency_upper, monetary_lower, monetary_upper)
segments %>%
  kable() %>%
  kable_styling(full_width = TRUE, font_size = 12) 
```

## Segment Size

<hr>

<br>
<br>

```{r rfm_customers, echo=FALSE}
segments %>%
  count(segment) %>%
  arrange(desc(n)) %>%
  rename(Segment = segment, Count = n)
```

## Median Recency

<hr>

<br>

```{r avg_recency, fig.align='center', fig.height=5, fig.width=6, echo=FALSE}
rfm_plot_median_recency(segments)
```

## Median Frequency

<hr>

<br>

```{r avg_frequency, fig.align='center', fig.height=5, fig.width=6, echo=FALSE}
rfm_plot_median_frequency(segments)
```

## Median Monetary Value

<hr>

<br>

```{r avg_monetary, fig.align='center', fig.height=5, fig.width=6, echo=FALSE}
rfm_plot_median_monetary(segments)
```

## {data-background="img/ws_section_summary.png"}

## Summary

<hr>

## {data-background="img/thankyou.png"}

