---
title: "Introduction to tibbles"
output: 
  revealjs::revealjs_presentation:
    transition: slide
    incremental: true
    theme: default
    highlight: haddock
    center: false
    reveal_options:
      slideNumber: true
      previewLinks: true
---

<style type="text/css">
  .reveal p {
    text-align: left;
    font-size: 20px;
  }
  .reveal body:after {
    content: url(handshake.png);
    position: fixed;
    bottom: 3.5em;
    left: 3.5em;
    box-shadow: 5px 5px 10px #000; 
  }
  .reveal hr {
    border-color: #0077aa;
  }
  .reveal h1, h2, h3, h4, h5, h6 {
    text-transform: capitalize;
    text-align: center;
    color: #0077aa;
    font-family: 'Helvetica Neue';
  }
  .reveal ul {
    display: block;
  }
  .reveal ul li {
    color: #3c3c3c; 
    /* set color of list item text */
    list-style: none; 
  }

  .reveal ul li::before {
      color: #006b6e;  
      /* color of bullet or square */
      content: "\2022"; 
      /* Unicode of character to precede the list item */
      font-size: 1em; 
      /* em or %*/ 
      padding-right: 1.1225em; 
      /* use em*/
      position: relative;
      top: 0em; 
      /* use em or % */
  }
  .reveal ul {
    line-height:150%
  }
  .reveal .fragment {
    font-size: 20px;
  }
  .reveal ol {
    display: block;
  }
</style>

## Agenda

<hr>

- What are tibbles?
- How are tibbles different from data frames?
- How to create tibbles?
- How to manipulate tibbles?


## tibbles

<hr>

A modern version of data frames that retain the good aspects (of data frames) while getting rid of the frustrating and annoying parts. 

## Creating tibbles

<hr>

tibble can be created using any of the following:

- `tibble()`
- `as_tibble()`
- `tribble()`

## Creating tibbles

<hr>

```{r tibble1, echo=FALSE, eval=TRUE, results='hide', message=FALSE}
library(tibble)
library(dplyr)
```

```{r tibble2}
tibble(x = letters,
       y = 1:26,
       z = sample(100, 26))
```

## tibble features

<hr>

- never changes input's types
- never adjusts variable names
- never prints all rows
- never recycles vector of length greater than 1

## never changes input's types

<hr>

```{r tibble3}
tibble(x = letters,
       y = 1:26,
       z = sample(100, 26))
```

## never adjusts variable names

<hr>

```{r tibble4}
names(data.frame(`order value` = 10))
names(tibble(`order value` = 10))
```

## never prints all rows

<hr>

```{r tibble5}
x <- 1:100
y <- letters[1]
z <- sample(c(TRUE, FALSE), 100, replace = TRUE)
tibble(x, y, z)
```

## never recycle vector of length greater than 1

<hr>

```{r tibble6, eval=FALSE}
x <- 1:100
y <- letters
z <- sample(c(TRUE, FALSE), 100, replace = TRUE)
tibble(x, y, z)
Error in overscope_eval_next(overscope, expr) : object 'y' not found
```

## Creating tibbles II

<hr>

In the previous section, we created tibbles using the `tibble()` function by directly entering data as arguments. In this section, we will convert the following objects to tibble using the `as_tibble()` function:

- data.frame
- list
- matrix
- table
- tbl_df
- atomic vectors

## DataFrames

<hr>

```{r tibble7}
as_tibble(iris)
```

## Lists

<hr>

```{r tibble8}
l <- list(x = 1:32, y = sample(100, 32), z = replicate(32, letters, simplify = FALSE))
as_tibble(l)
```

## Matrix

<hr>

```{r tibble9}
m <- matrix(sample(1000, 2600, replace = TRUE), ncol = 26)
colnames(m) <- letters
as_tibble(m)
```

## Table

<hr>

```{r tibble10}
k <- table(mtcars$cyl)
as_tibble(k)
```

## tbl_df

<hr>

```{r tibble11}
k <- tbl_df(iris)
as_tibble(k)
```

## atomic vectors

<hr>

```{r tibble12}
browsers <- c('chrome', 'safari', 'firefox', 'edge')
enframe(browsers)
```

## atomic vectors

<hr>

```{r tibble13}
browsers <- c(chrome = 40, firefox = 20, edge = 30, safari = 10)
enframe(browsers)
```

## Test objects

<hr>

We can test if an object is a tibble using the `is_tibble()` function.

```{r tibble14}
is_tibble(mtcars)
is_tibble(as_tibble(mtcars))
```

## Tribble

<hr>

Another way to create tibbles is using `tribble()`: 

- it is short for transposed tibbles
- it is customized for data entry in code 
- column names start with `~` 
- and values are separated by commas

## Tribble

<hr>

```{r tibble15}
tribble(
  ~x, ~y, ~z,
  #--|--|----
  1, TRUE, 'a',
  2, FALSE, 'b'
)
```

## Column Names

<hr>

Names of the columns in tibbles need not be valid R variable names. They can contain unusual characters like a space or a smiley but must be enclosed in ticks. 

```{r tibble16}
tibble(
  ` ` = 'space',
  `2` = 'integer',
  `:)` = 'smiley'
)
```

## Compare tibbles

<hr>

We can compare tibbles using the `all_equal()` function from the [dplyr](http://dplyr.tidyverse.org/) package. We need to specify the 
tibbles being compared. Let us look at an example from the web traffic data. We have the details of browsers used in 2 formats. We will 
test if they are the same.

```{r tibble17} 
browsers1 <- enframe(c(chrome = 40, firefox = 20, edge = 30, safari = 10))
browsers2 <- enframe(c(edge = 30, firefox = 20, safari = 10, chrome = 40))
all_equal(browsers1, browsers2)
```

## Compare tibbles

<hr>

 The `all_equal()` function ignores the order of the rows while comparing the tibbles. Change this by setting 
`ignore_row_order` to `TRUE`.

```{r tibble18}
all_equal(browsers1, browsers2, ignore_row_order = FALSE)
```


## Compare tibbles

<hr>

The order of the columns are ignored by default.

```{r tibble19}
traffic1 <- tibble(
  browsers = c('chrome', 'firefox', 'edge', 'safari'),
  visit = c(40, 20, 30, 10),
  source = c('search', 'social', 'direct', 'affiliates'),
  visits = c(35, 25, 10, 30)
)

traffic2 <- tibble(
  source = c('search', 'social', 'direct', 'affiliates'),
  visits = c(35, 25, 10, 30),
  browsers = c('chrome', 'firefox', 'edge', 'safari'),
  visit = c(40, 20, 30, 10)
)

all_equal(traffic1, traffic2)
```


## Compare tibbles

<hr>

Set `ignore_col_order` to `FALSE` to compare the order of the columns.

```{r tibble20}
all_equal(traffic1, traffic2, ignore_col_order = FALSE)
```

## Add Rows

<hr>

Let us add data related to **Safari** browser to the web traffic data using the `add_row()` function.

```{r tibble21}
browsers <- enframe(c(chrome = 40, firefox = 20, edge = 30))
browsers
```

```{r tibble22}
add_row(browsers, name = 'safari', value = 10)
```

## Add Rows

<hr>

If we want to add the data at a particular row, we can specify the row number using the `.before` argument.
Let us add the data related to **Safari** browser in the second row instead of the last row.

```{r tibble23}
add_row(browsers, name = 'safari', value = 10, .before = 2)
```

## Add Column

<hr>

`add_col()` adds a new column to tibbles.

```{r tibble24}
browsers <- enframe(c(chrome = 40, firefox = 20, edge = 30, safari = 10))
add_column(browsers, visits = c(4000, 2000, 3000, 1000))
```

## Rownames

<hr>

The [tibble](tibble.tidyverse.org) package provides a set of functions to deal with rownames. Remember, `tibble` does
not have `rownames` unlike `data.frame`. To check whether a data set has rownames, use the `has_rownames()` function.

```{r tibble25}
has_rownames(mtcars)
```

## Remove Rownames

<hr>

```{r tibble26}
remove_rownames(mtcars)
```

## Rownames to Column

<hr>

```{r tibble27}
head(rownames_to_column(mtcars))
```

## Column to Rownames

<hr>

To convert the first column in the data set to rownames, use the `column_to_rownames()` function:

```{r tibble28}
mtcars_tbl <- rownames_to_column(mtcars)
column_to_rownames(mtcars_tbl)
```

## Miscellaneous

<hr>

Use the `glimpse()` function to get an overview of the data.

```{r tibble 29}
glimpse(mtcars)
```

## Column Exists

<hr>

The `has_name()` function can be used to check if a tibble has a specific column.

```{r tibble30}
has_name(mtcars, 'cyl')
has_name(mtcars, 'gears')
```

## Questions

<hr>

## Thank You

<hr>