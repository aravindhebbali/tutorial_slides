---
output: _output.yaml
---

## {data-background="import.png"}

## Agenda

<hr>

read data from 

  - xls
  - xlsx
  - SAS
  - SPSS
  - STATA

## Libraries

<hr>

```{r importlib1,eval=FALSE}
library(readxl)
library(haven)
library(foreign)
library(sas7bdat)
```

```{r importlib2, echo=FALSE, eval=TRUE, results='hide', message=FALSE}
library(readxl)
library(haven)
library(foreign)
library(sas7bdat)
```

## Overview

<hr>

- list sheets in an excel file
- read data from an excel sheet
- read specific cells from an excel sheet
- read a single row
- read a single column
- read several rows
- read several columns


## List Sheets

<hr>

```{r import55}
excel_sheets('sample2.xls')
```

## Read Sheet

<hr>

```{r import56, echo=TRUE, results='markup', message=FALSE}
readxl::read_excel('sample2.xls', sheet = 1)
```

## Read Specific Cells

<hr>

```{r import58, echo=TRUE, results='markup', message=FALSE}
readxl::read_excel('sample2.xls', sheet = 2, range = "B3:C7")
```

Remember first row is always column name in excel so add 1 to row number while selecting the cell.

## Read Specific Cells

<hr>

```{r import59, echo=TRUE, results='markup', message=FALSE}
readxl::read_excel('sample2.xls', sheet = 2, range = "A3:C5")
```

## Read Specific Cells

<hr>

```{r import61, echo=TRUE, results='markup', message=FALSE}
readxl::read_excel('sample2.xls', sheet = 2, col_names = FALSE,
  range = anchored("A4", dim = c(3, 2)))
```

## Read Specific Cells

<hr>

```{r import65, echo=TRUE, results='markup', message=FALSE}
readxl::read_excel('sample2.xls', sheet = 2,
  range = cell_limits(c(1, 2), c(NA, NA)))
```

Use cell_limits to specify one end of the rectangle such as top left or top right.

## Read Specific Cells

<hr>

```{r import66, echo=TRUE, results='markup', message=FALSE}
readxl::read_excel('sample2.xls', sheet = 2,
  range = cell_limits(c(3, NA), c(NA, 2)))
```

## Read Single Row

<hr>

```{r import60, echo=TRUE, results='markup', message=FALSE}
readxl::read_excel('sample2.xls', sheet = 2, range = "A3:C4")
```

## Read Single Column

<hr>

```{r import64, echo=TRUE, results='markup', message=FALSE}
readxl::read_excel('sample2.xls', sheet = 2, range = cell_cols(2))
```


## Specify Rows

<hr>

```{r import62, echo=TRUE, results='markup', message=FALSE}
readxl::read_excel('sample2.xls', sheet = 2, range = cell_rows(3:6))
```

## Specify Columns

<hr>

```{r import63, echo=TRUE, results='markup', message=FALSE}
readxl::read_excel('sample2.xls', sheet = 2, range = cell_cols(2:3))
```


## Statistical Softwares

<hr>

- SAS
- SPSS
- STATA

## haven

<hr>

- `read_dta()`
- `read_stata()`
- `read_sav()`
- `read_spss()`
- `read_sas()`


## Other Libraries

<hr>

- SAS: sas7bdat (last updated in 2014; version 0.5)
- STATA, SPSS: foreign (maintained; version 0.8)

## stata

<hr>

- `read_dta()`
- `read_stata()`
- `read.dta()`

## stata

<hr>

```{r import67, echo=TRUE, results='markup', message=FALSE}
haven::read_dta('airline.dta')    
```

## stata

<hr>

```{r import68, echo=TRUE, results='markup', message=FALSE}
haven::read_stata('airline.dta')  
```

## stata

<hr>

```{r import69}
foreign::read.dta('airline.dta')  
```

## spss

<hr>

- `read_sav()`
- `read_spss()`
- `read.spss()`

## spss

<hr>

```{r import70, echo=TRUE, results='markup', message=FALSE}
read_sav('employee.sav')   
```

## spss

<hr>

```{r import71, echo=TRUE, results='markup', message=FALSE}
read_spss('employee.sav')  
```

## spss

<hr>

```{r import72}
foreign::read.spss('employee.sav', use.value.labels = FALSE,
                   to.data.frame = TRUE)
```

## SAS

<hr>

- `read_sas()`
- `read.sas7bdat()`

## SAS

<hr>

```{r import73, echo=TRUE, results='markup', message=FALSE}
read_sas('airline.sas7bdat')
```

## SAS

<hr>

```{r import74}
sas7bdat::read.sas7bdat('airline.sas7bdat')
```

## {data-background="thankyou.png"}


<!-- To do: -->
<!--   - change data -->
<!--   - 1 paragraph about statistical softwares -->
<!--   - use excel sheet while explaining readxl -->
