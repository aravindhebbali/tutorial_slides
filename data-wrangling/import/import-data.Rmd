---
title: "Importing Data into R: Part - 2"
output: 
  revealjs::revealjs_presentation:
    transition: slide
    incremental: true
    theme: default
    highlight: haddock
    center: false
    reveal_options:
      slideNumber: true
      previewLinks: true
---

<style type="text/css">
  .reveal p {
    text-align: left;
    font-size: 20px;
  }
  .reveal body:after {
    content: url(handshake.png);
    position: fixed;
    bottom: 3.5em;
    left: 3.5em;
    box-shadow: 5px 5px 10px #000; 
  }
  .reveal hr {
    border-color: #0077aa;
  }
  .reveal h1, h2, h3, h4, h5, h6 {
    text-transform: capitalize;
    text-align: center;
    color: #0077aa;
    font-family: 'Helvetica Neue';
  }
  .reveal ul {
    display: block;
  }
  .reveal ul li {
    color: #3c3c3c; 
    /* set color of list item text */
    list-style: none; 
  }
  .reveal .sourceCode pre code {
		padding: 0px;
		border: 0px;
	}
  .reveal ul li::before {
      color: #006b6e;  
      /* color of bullet or square */
      content: "\2022"; 
      /* Unicode of character to precede the list item */
      font-size: 1em; 
      /* em or %*/ 
      padding-right: 1.1225em; 
      /* use em*/
      position: relative;
      top: 0em; 
      /* use em or % */
  }
  .reveal ul {
    line-height:150%
  }
  .reveal .fragment {
    font-size: 20px;
  }
  .reveal ol {
    display: block;
  }
</style>

## Agenda

<hr>

* read data from excel sheets
  - xls
  - xlsx
* read data from 
  - SAS
  - SPSS
  - STATA



## Introdction

<hr>

Importing data is the first step in any data analysis workflow. If you cannot import data from differernt sources or file formats, you cannot proceed with data analysis. R allows you to import data from several sources and a variety of file formats. In this module, we will focus on excel and statistical softwares.

## Libraries

<hr>

```{r importlib1,eval=FALSE}
library(readxl)
library(haven)
library(foreign)
library(sas7bdat)
```

```{r importlib2, echo=FALSE, eval=TRUE, results='hide', message=FALSE}
library(readxl)
library(haven)
library(foreign)
library(sas7bdat)
```

## readxl

<hr>


## Excel

<hr>

list sheets in a excel file

```{r import55}
excel_sheets('sample2.xls')
```

## Excel

<hr>

```{r import56, echo=TRUE, results='markup', message=FALSE}
readxl::read_excel('sample2.xls', sheet = 1)
```

## Excel

<hr>

```{r import57, echo=TRUE, results='markup', message=FALSE}
readxl::read_excel('sample2.xls', sheet = 2)
```

## Excel

<hr>

read specific cells

remember first row is always column name in excel so add 1 to row number while selecting the cell

```{r import58, echo=TRUE, results='markup', message=FALSE}
readxl::read_excel('sample2.xls', sheet = 2,
                   range = "B3:C7")
```

## Excel

<hr>


```{r import59, echo=TRUE, results='markup', message=FALSE}
readxl::read_excel('sample2.xls', sheet = 2,
                   range = "A3:C5")
```

## Excel

<hr>

single row

```{r import60, echo=TRUE, results='markup', message=FALSE}
readxl::read_excel('sample2.xls', sheet = 2,
                   range = "A3:C4")
```

## Excel

<hr>


```{r import61, echo=TRUE, results='markup', message=FALSE}
readxl::read_excel('sample2.xls', sheet = 2,
                   range = anchored("A4", dim = c(3, 2)),
                   col_names = FALSE)
```

## Excel

<hr>

specify only rows

```{r import62, echo=TRUE, results='markup', message=FALSE}
readxl::read_excel('sample2.xls', sheet = 2,
                   range = cell_rows(3:6))
```

## Excel

<hr>

specify only columns

```{r import63, echo=TRUE, results='markup', message=FALSE}
readxl::read_excel('sample2.xls', sheet = 2,
                   range = cell_cols(2:3))
```

## Excel

<hr>

single column

```{r import64, echo=TRUE, results='markup', message=FALSE}
readxl::read_excel('sample2.xls', sheet = 2,
                   range = cell_cols(2))
```

## Excel

<hr>

use cell_limits to specify one end of the rectangle such as top left or top right

```{r import65, echo=TRUE, results='markup', message=FALSE}
readxl::read_excel('sample2.xls', sheet = 2,
                   range = cell_limits(c(1, 2), c(NA, NA)))
```

## Excel

<hr>

```{r import66, echo=TRUE, results='markup', message=FALSE}
readxl::read_excel('sample2.xls', sheet = 2,
                   range = cell_limits(c(3, NA), c(NA, 2)))
```

## Statistical Software

<hr>

## haven

<hr>

## Other Libraries

<hr>

other packages that can be used to import the files

- sas: sas7bdat (last updated in 2014; version 0.5)
- stata, spss: foreign (maintained; version 0.8)

## stata

<hr>

```{r import67, echo=TRUE, results='markup', message=FALSE}
haven::read_dta('airline.dta')    # tibble
```

## stata

<hr>

```{r import68, echo=TRUE, results='markup', message=FALSE}
haven::read_stata('airline.dta')  # tibble
```

## stata

<hr>

```{r import69}
foreign::read.dta('airline.dta')  # data.frame
```

## spss

<hr>

```{r import70, echo=TRUE, results='markup', message=FALSE}
read_sav('employee.sav')   # tibble
```

## spss

<hr>

```{r import71, echo=TRUE, results='markup', message=FALSE}
read_spss('employee.sav')  # tibble
```

## spss

<hr>

```{r import72}
foreign::read.spss('employee.sav', use.value.labels = FALSE,
                   to.data.frame = TRUE)
```

## SAS

<hr>

```{r import73, echo=TRUE, results='markup', message=FALSE}
read_sas('airline.sas7bdat')
```

## SAS

<hr>

```{r import74}
sas7bdat::read.sas7bdat('airline.sas7bdat')
```

## Questions

<hr>

## Thank You

<hr>