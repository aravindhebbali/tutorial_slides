---
title: "Importing Data into R: Part - 1"
output: 
  revealjs::revealjs_presentation:
    transition: slide
    incremental: true
    theme: moon
    highlight: monochrome
    center: true
    fig_width: 6
    fig_height: 5
    reveal_options:
      slideNumber: true
      previewLinks: true
---

## Introdction

## Libraries

```{r importlib1,eval=FALSE}
library(readr)
library(readxl)
library(haven)
library(jsonlite)
library(xml2)
library(foreign)
library(sas7bdat)
```

```{r importlib2, echo=FALSE, eval=TRUE, results='hide', message=FALSE}
library(readr)
library(readxl)
library(haven)
library(jsonlite)
library(xml2)
library(foreign)
library(sas7bdat)
```


# CSV 

## comma separated values

```{r import1}
read.csv('hsb2.csv', header = TRUE)
```

## using readr

----

```{r import2, echo=TRUE, results='markup', message=FALSE}
read_csv('hsb2.csv')
```

----

```{r import3, echo=TRUE, results='markup', message=FALSE}
read_delim('hsb2.csv', delim = ',')
```

## data does not include column names

----

```{r import4, echo=TRUE, results='markup', message=FALSE}
read_csv('hsb2.csv', col_names = FALSE)
```

----

```{r import5, echo=TRUE, results='markup', message=FALSE}
read_delim('hsb2.csv', delim = ',', col_names = FALSE)
```

## skip a few lines

----

```{r import6, echo=TRUE, results='markup', message=FALSE}
read_csv('hsb2.csv', skip = 5)
```

----

```{r import7, echo=TRUE, results='markup', message=FALSE}
read_delim('hsb2.csv', delim = ',', skip = 5)
```

## maximum number of lines to read

----

```{r import8, echo=TRUE, results='markup', message=FALSE}
read_csv('hsb2.csv', n_max = 50)
```

----

```{r import9, echo=TRUE, results='markup', message=FALSE}
read_delim('hsb2.csv', delim = ',', n_max = 50)
```

## specify column types

```{r import10, echo=TRUE, results='markup', message=FALSE}
read_csv('hsb2.csv',
  col_types = list(col_integer(), col_factor(levels = c(0, 1)), 
                   col_factor(levels = c(1, 2, 3, 4)),
                   col_factor(levels = c(1, 2, 3)), 
                   col_factor(levels = c(1, 2)), 
                   col_factor(levels = c(1, 2, 3)),
                   col_integer(), col_integer(), col_integer(),
                   col_integer(), col_integer())            
)
```

## read only specific columns

```{r import11, echo=TRUE, results='markup', message=FALSE}
read_csv('hsb2.csv', 
  col_types = cols_only(id = col_integer(),
                        prog = col_factor(levels = c(1, 2, 3)),
                        read = col_integer())
)
```

# parse_* functions

```{r import12, eval = FALSE}
```

## parse_character()

```{r import13, eval = FALSE}
```

## parse_date()

```{r import14, eval = FALSE}
```

## parse_datetime()

```{r import15, eval = FALSE}
```

## parse_double()

```{r import16, eval = FALSE}
```

## parse_factor()

```{r import17, eval = FALSE}
```

## parse_integer()

```{r import18, eval = FALSE}
```

## parse_guess()

```{r import19, eval = FALSE}
```

## spec_csv()

## semicolon separated values

```{r import20, echo=TRUE, results='markup', message=FALSE}
read.csv2('hsb.csv', header = TRUE)
```

## using readr

----

```{r import21, echo=TRUE, results='markup', message=FALSE}
read_csv2('hsb.csv')
```

----

```{r import22, echo=TRUE, results='markup', message=FALSE}
read_delim('hsb.csv', delim = ';')
```

## data does not include column names

----

```{r import23, echo=TRUE, results='markup', message=FALSE}
read_csv2('hsb.csv', col_names = FALSE)
```

----

```{r import24, echo=TRUE, results='markup', message=FALSE}
read_delim('hsb.csv', delim = ';', col_names = FALSE)
```

## skip a few lines

----

```{r import25, echo=TRUE, results='markup', message=FALSE}
read_csv2('hsb.csv', skip = 5)
```

----

```{r import26, echo=TRUE, results='markup', message=FALSE}
read_delim('hsb.csv', delim = ';', skip = 5)
```

## maximum number of lines to read

----

```{r import27, echo=TRUE, results='markup', message=FALSE}
read_csv2('hsb.csv', n_max = 50)
```

----

```{r import28, echo=TRUE, results='markup', message=FALSE}
read_delim('hsb.csv', delim = ';', n_max = 50)
```

## specify column types

```{r import29, echo=TRUE, results='markup', message=FALSE}
read_csv2('hsb.csv',
         col_types = list(col_integer(), col_factor(levels = c(0, 1)), 
                          col_factor(levels = c(1, 2, 3, 4)),
                          col_factor(levels = c(1, 2, 3)), 
                          col_factor(levels = c(1, 2)), 
                          col_factor(levels = c(1, 2, 3)),
                          col_integer(), col_integer(), col_integer(),
                          col_integer(), col_integer())            
)
```

## read only specific columns

```{r import30, echo=TRUE, results='markup', message=FALSE}
read_csv2('hsb.csv', 
         col_types = cols_only(id = col_integer(),
                               prog = col_factor(levels = c(1, 2, 3)),
                               read = col_integer())
)
```

## tab separated values

```{r import31}
read.delim('mtcars.tsv', dec = '.')  
```

## use read.delim2 if decimal separator is ,

```{r import32}
read.table('mtcars.tsv', sep = '\t', header = TRUE, dec = '.')
```

## using readr

----

```{r import33, echo=TRUE, results='markup', message=FALSE}
read_tsv('mtcars.tsv')
```

----

```{r import34, echo=TRUE, results='markup', message=FALSE}
read_delim('mtcars.tsv', delim = '\t')
```

## data does not include column names

----

```{r import35, echo=TRUE, results='markup', message=FALSE}
read_tsv('mtcars.tsv', col_names = FALSE)
```

----

```{r import36, echo=TRUE, results='markup', message=FALSE}
read_delim('mtcars.tsv', delim = '\t', col_names =  FALSE)
```

## skip a few lines

----

```{r import37, echo=TRUE, results='markup', message=FALSE}
read_tsv('mtcars.tsv', skip = 5)
```

----

```{r import38, echo=TRUE, results='markup', message=FALSE}
read_delim('mtcars.tsv', delim = '\t', skip = 5)
```

## maximum number of lines to read

----

```{r import39, echo=TRUE, results='markup', message=FALSE}
read_tsv('mtcars.tsv', n_max = 10)
```

----

```{r import40, echo=TRUE, results='markup', message=FALSE}
read_delim('mtcars.tsv', delim = '\t', n_max = 10)
```

## specify column types

```{r import41, echo=TRUE, results='markup', message=FALSE}
read_tsv('mtcars.tsv',
          col_types = list(col_double(), col_factor(levels = c(4, 6, 8)), 
                           col_double(), col_double(), col_double(),
                           col_double(), col_double(),
                           col_factor(levels = c(0, 1)), 
                           col_factor(levels = c(0, 1)), 
                           col_factor(levels = c(3, 4, 5)),
                           col_factor(levels = c(1, 2, 3, 4, 6, 8)))            
)
```

## read only specific columns

```{r import42, echo=TRUE, results='markup', message=FALSE}
read_tsv('mtcars.tsv', 
          col_types = cols_only(mpg = col_double(),
                                cyl = col_factor(levels = c(4, 6, 8)),
                                disp = col_double(),
                                gear = col_factor(levels = c(3, 4, 5)))
)
```

# space separated values

----

```{r import43}
read.table('hsb1.csv', header = TRUE, sep = " ")
```

----

```{r import44, eval = FALSE}
read_table('hsb1.csv')  # fails
```

----

```{r import45, echo=TRUE, results='markup', message=FALSE}
read_table2('hsb1.csv')
```

## data does not include column names

```{r import46, echo=TRUE, results='markup', message=FALSE}
read_table2('hsb1.csv', col_names = FALSE)
```

## skip a few lines

```{r import47, echo=TRUE, results='markup', message=FALSE}
read_table2('hsb1.csv', skip = 5)
```

## maximum number of lines to read

```{r import48, echo=TRUE, results='markup', message=FALSE}
read_table2('hsb1.csv', n_max = 10)
```

## specify column types

```{r import49, echo=TRUE, results='markup', message=FALSE}
read_table2('hsb1.csv',
          col_types = list(col_integer(), col_factor(levels = c(0, 1)), 
                           col_factor(levels = c(1, 2, 3, 4)),
                           col_factor(levels = c(1, 2, 3)), 
                           col_factor(levels = c(1, 2)), 
                           col_factor(levels = c(1, 2, 3)),
                           col_integer(), col_integer(), col_integer(),
                           col_integer(), col_integer())            
)
```

## read only specific columns

```{r import50, echo=TRUE, results='markup', message=FALSE}
read_table2('hsb1.csv', 
          col_types = cols_only(id = col_integer(),
                                prog = col_factor(levels = c(1, 2, 3)),
                                read = col_integer())
)
```

# read .txt files

----

```{r import51, eval = FALSE}
read_csv('hsb.txt')  # incorrect
```

----

```{r import52, eval = FALSE}
read_delim('hsb.txt', delim = ',')  # incorrect
```

----

```{r import53, eval = FALSE}
read_table('hsb.txt')  # incorrect
```

----

```{r import54, echo=TRUE, results='markup', message=FALSE}
read_table2('hsb.txt')  # correct
```

# read excel files

## list sheets in a excel file

```{r import55}
excel_sheets('sample2.xls')
```

----

```{r import56, echo=TRUE, results='markup', message=FALSE}
readxl::read_excel('sample2.xls', sheet = 1)
```

----

```{r import57, echo=TRUE, results='markup', message=FALSE}
readxl::read_excel('sample2.xls', sheet = 2)
```

## remember first row is always column name in excel
## so add 1 to row number while selecting the cell

## read specific cells

----

```{r import58, echo=TRUE, results='markup', message=FALSE}
readxl::read_excel('sample2.xls', sheet = 2,
                   range = "B3:C7")
```

----

```{r import59, echo=TRUE, results='markup', message=FALSE}
readxl::read_excel('sample2.xls', sheet = 2,
                   range = "A3:C5")
```

## single row

----

```{r import60, echo=TRUE, results='markup', message=FALSE}
readxl::read_excel('sample2.xls', sheet = 2,
                   range = "A3:C4")
```

----

```{r import61, echo=TRUE, results='markup', message=FALSE}
readxl::read_excel('sample2.xls', sheet = 2,
                   range = anchored("A4", dim = c(3, 2)),
                   col_names = FALSE)
```

## specify only rows

```{r import62, echo=TRUE, results='markup', message=FALSE}
readxl::read_excel('sample2.xls', sheet = 2,
                   range = cell_rows(3:6))
```

## specify only columns

```{r import63, echo=TRUE, results='markup', message=FALSE}
readxl::read_excel('sample2.xls', sheet = 2,
                   range = cell_cols(2:3))
```

## single column

```{r import64, echo=TRUE, results='markup', message=FALSE}
readxl::read_excel('sample2.xls', sheet = 2,
                   range = cell_cols(2))
```

## use cell_limits to specify one end of the rectangle

## such as top left or top right

----

```{r import65, echo=TRUE, results='markup', message=FALSE}
readxl::read_excel('sample2.xls', sheet = 2,
                   range = cell_limits(c(1, 2), c(NA, NA)))
```

----

```{r import66, echo=TRUE, results='markup', message=FALSE}
readxl::read_excel('sample2.xls', sheet = 2,
                   range = cell_limits(c(3, NA), c(NA, 2)))
```

# mention other packages that can be used to import the files
## sas: sas7bdat (last updated in 2014; version 0.5)
## stata, spss: foreign (maintained; version 0.8)

## stata

----

```{r import67, echo=TRUE, results='markup', message=FALSE}
haven::read_dta('airline.dta')    # tibble
```

----

```{r import68, echo=TRUE, results='markup', message=FALSE}
haven::read_stata('airline.dta')  # tibble
```

----

```{r import69}
foreign::read.dta('airline.dta')  # data.frame
```

## spss

----

```{r import70, echo=TRUE, results='markup', message=FALSE}
read_sav('employee.sav')   # tibble
```

----

```{r import71, echo=TRUE, results='markup', message=FALSE}
read_spss('employee.sav')  # tibble
```

----

```{r import72}
foreign::read.spss('employee.sav', use.value.labels = FALSE,
                   to.data.frame = TRUE)
```

## stata

----

```{r import73, echo=TRUE, results='markup', message=FALSE}
read_sas('airline.sas7bdat')
```

----

```{r import74}
sas7bdat::read.sas7bdat('airline.sas7bdat')
```

## Summary

## Next Steps..