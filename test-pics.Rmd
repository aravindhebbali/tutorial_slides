---
title: "Web Scraping "
author: "Aravind Hebbali"
date: "8 April 2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r cover_image, echo=FALSE, fig.align='center', out.width="80%"}
knitr::include_graphics("web-scraping/img/ws_meme.jpg")
```

## Introduction

<hr>

So you want to know the range of products being sold by your competitor. You go 
to their website and see all the products (along with the details) and want to 
compare it with your own range of products. Great! How do you do that? How do 
you get the details available on the website into a format in which you can 
analyse it?

- Can you copy/paste the data from their website?
- Can you see some save button?
- Can you download the data?

Hmmm.. If you have these or similar questions on your mind, you have come to 
the right place. In this post, we will learn about web scraping using R. **If 
you like a more structured approach, try our free online course, 
[Web Scraping with R]()**.

## The What?

<hr>

```{r cover_what, echo=FALSE, fig.align='center', out.width="80%"}
knitr::include_graphics("web-scraping/img/blog_ws_what_border.png")
```

So, what exactly is web scraping or web mining or web harvesting? It is a 
technique for extracting data from websites. Remember, websites contain wealth 
of useful data but designed for human consumption and not data analysis. The 
goal of web scraping is to take advantage of the pattern or structure of web 
pages to extract and store data in a format suitable for data analysis.

## The Why?

<hr>

```{r why, echo=FALSE, fig.align='center', out.width="80%"}
knitr::include_graphics("web-scraping/img/blog_ws_why_border.png")
```

- data not available in a suitable format
- copy/paste does not work
- no option to save/download data
- automate data extraction/harvesting

## The How?

<hr>

```{r how, echo=FALSE, fig.align='center', out.width="80%"}
knitr::include_graphics("web-scraping/img/blog_ws_how_border.png")
```

- check robots.txt file
- fetch the web page
- extract, store & analyze

## Use Cases

<hr>

```{r use_cases, echo=FALSE, fig.align='center', out.width="80%"}
knitr::include_graphics("web-scraping/img/blog_ws_use_cases_border.png")
```

- scraping contact details
- monitoring online price changes
- comparing prices across websites
- scraping reviews/ratings
- real estate listings
- used car prices

## Things to keep in mind...

<hr>

```{r keep_in_mind, echo=FALSE, fig.align='center', out.width="80%"}
knitr::include_graphics("web-scraping/img/blog_ws_keep_in_mind_border.png")
```

- best for static & well structured web pages
- the underling HTML code can change anytime
- if an API is availabel, please use it
- do not overwhelm websites with requests as you run
the risk of getting blocked
- review robots.txt file to ensure that you are not
violating any terms and conditions

## Case Studies

<hr>

```{r case_studies, echo=FALSE, fig.align='center', out.width="80%"}
knitr::include_graphics("web-scraping/img/blog_ws_case_studies_border.png")
```

- best selling mobile phones
- IMDB top 50 movies
- most visited websites 
- list of RBI governors

## HTML Basics

<hr>

To be able to scrape data from websites, we need to understand how the web 
pages are structured. In this section, we will learn enough about HTML to be 
able to start scraping data from websites.

### HTML, CSS & JAVASCRIPT

<hr>

```{r html_css_js, echo=FALSE, fig.align='center', out.width="80%"}
knitr::include_graphics("web-scraping/img/html_css_js_2.png")
```

### HTML Tags

<hr>

```{r html_tags, echo=FALSE, fig.align='center', out.width="80%"}
knitr::include_graphics("web-scraping/img/html_tags.jpg")
```

### DOM 

<hr>

```{r html_dom, echo=FALSE, fig.align='center', out.width="80%"}
knitr::include_graphics("web-scraping/img/blog_ws_html_dom_border.png")
```

### HTML Attributes

<hr>

```{r html_attributes, echo=FALSE, fig.align='center', out.width="80%"}
knitr::include_graphics("web-scraping/img/blog_ws_html_attributes_crop.png")
```

### Class, Div & Style

<hr>

```{r html_tags_2, echo=FALSE, fig.align='center', out.width="80%"}
knitr::include_graphics("web-scraping/img/blog_ws_html_tags_2_border.png")
```

## Libraries

<hr>

```{r libs, message=FALSE, warning=FALSE}
library(robotstxt)
library(rvest)
library(selectr)
library(xml2)
library(dplyr)
library(stringr)
library(forcats)
library(magrittr)
library(tidyr)
library(ggplot2)
library(lubridate)
library(tibble)
library(purrr)
```

## Best Selling Mobile Phones

<hr>

```{r top_mobiles, echo=FALSE, fig.align='center', out.width="80%"}
knitr::include_graphics("web-scraping/img/blog_ws_cs_top_mobiles_border.png")
```

### Brand Name

<hr>

```{r mobile_brand_name, echo=FALSE, fig.align='center', out.width="80%"}
knitr::include_graphics("web-scraping/img/blog_ws_mobile_brand_name_border.png")
```

### Color

<hr>

```{r mobile_color, echo=FALSE, fig.align='center', out.width="80%"}
knitr::include_graphics("web-scraping/img/blog_ws_mobile_color_border.png")
```

### Rating

<hr>

```{r mobile_rating, echo=FALSE, fig.align='center', out.width="80%"}
knitr::include_graphics("web-scraping/img/blog_ws_mobile_rating_border.png")
```

### Number of Reviews

<hr>

```{r mobile_reviews, echo=FALSE, fig.align='center', out.width="80%"}
knitr::include_graphics("web-scraping/img/blog_ws_mobile_reviews_border.png")
```

### Real Price

<hr>

```{r mobile_real_price, echo=FALSE, fig.align='center', out.width="80%"}
knitr::include_graphics("web-scraping/img/blog_ws_real_price_border.png")
```

### Actual Price

<hr>

```{r mobile_actual_price, echo=FALSE, fig.align='center', out.width="80%"}
knitr::include_graphics("web-scraping/img/blog_ws_actual_price_border.png")
```

## IMDB Top 50 

<hr>

```{r imdb_top_50, echo=FALSE, fig.align='center', out.width="80%"}
knitr::include_graphics("web-scraping/img/blog_ws_cs_imdb_top_50_border.png")
```

### Title

<hr>

```{r imdb_movie_name, echo=FALSE, fig.align='center', out.width="80%"}
knitr::include_graphics("web-scraping/img/blog_ws_imdb_movie_name_border.png")
```

### Year of Release

<hr>

```{r imdb_movie_year, echo=FALSE, fig.align='center', out.width="80%"}
knitr::include_graphics("web-scraping/img/blog_ws_imdb_movie_year_border.png")
```

### Certificate

<hr>

```{r imdb_movie_certificate, echo=FALSE, fig.align='center', out.width="80%"}
knitr::include_graphics("web-scraping/img/blog_ws_imdb_movie_certificate_border.png")
```

### Runtime

<hr>

```{r imdb_movie_runtime, echo=FALSE, fig.align='center', out.width="80%"}
knitr::include_graphics("web-scraping/img/blog_ws_imdb_movie_runtime_border.png")
```

### Genre

<hr>

```{r imdb_movie_genre, echo=FALSE, fig.align='center', out.width="80%"}
knitr::include_graphics("web-scraping/img/blog_ws_imdb_movie_genre_border.png")
```

### Rating

<hr>

```{r imdb_movie_rating, echo=FALSE, fig.align='center', out.width="80%"}
knitr::include_graphics("web-scraping/img/blog_ws_imdb_movie_rating_border.png")
```

### XPATH

<hr>

```{r imdb_movie_xpath, echo=FALSE, fig.align='center', out.width="80%"}
knitr::include_graphics("web-scraping/img/blog_ws_html_xpath_border.png")
```

### Votes

<hr>

```{r imdb_movie_votes, echo=FALSE, fig.align='center', out.width="80%"}
knitr::include_graphics("web-scraping/img/blog_ws_imdb_movie_votes_border.png")
```

### Revenue

<hr>

```{r imdb_movie_revenue, echo=FALSE, fig.align='center', out.width="80%"}
knitr::include_graphics("web-scraping/img/blog_ws_imdb_movie_revenue_border.png")
```

## Top Websites

<hr>

```{r top_websites, echo=FALSE, fig.align='center', out.width="80%"}
knitr::include_graphics("web-scraping/img/blog_ws_cs_top_websites_border.png")
```

## RBI Governors

<hr>

```{r rbi_governors, echo=FALSE, fig.align='center', out.width="80%"}
knitr::include_graphics("web-scraping/img/blog_ws_rbi_governors_border.png")
```

## Summary

<hr>

- web scraping is the extraction of data from web sites
- best for static & well structured HTML pages
- review robots.txt file  
- HTML code can change any time
- if API is available, please use it
- do not overwhelm websites with requests















